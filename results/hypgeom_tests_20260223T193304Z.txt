......................F.                                                 [100%]
================================== FAILURES ===================================
___________________ test_hypgeom_lower_level_helpers_shapes ___________________

    def test_hypgeom_lower_level_helpers_shapes():
        xr = jnp.array([0.2, 0.3], dtype=jnp.float64)
        xc = jnp.array([0.2, 0.25, 0.1, 0.15], dtype=jnp.float64)
    
        coeffs = hypgeom.arb_hypgeom_rising_coeffs_1(5, 6)
        _check(coeffs.shape == (6,))
        coeffs = hypgeom.arb_hypgeom_rising_coeffs_2(5, 6)
        _check(coeffs.shape == (6,))
        coeffs = hypgeom.arb_hypgeom_rising_coeffs_fmpz(5, 6)
        _check(coeffs.shape == (6,))
    
        shallow = hypgeom.arb_hypgeom_gamma_coeff_shallow(2)
        _check(shallow.shape == (2,))
    
        bounds = hypgeom.arb_hypgeom_gamma_stirling_term_bounds(jnp.array(0.2, dtype=jnp.float64), 4)
        _check(bounds.shape == (4,))
    
        n1 = hypgeom.arb_hypgeom_gamma_lower_fmpq_0_choose_N(xr, xr)
        n2 = hypgeom.arb_hypgeom_gamma_upper_fmpq_inf_choose_N(xr, xr)
        n3 = hypgeom.arb_hypgeom_gamma_upper_singular_si_choose_N(2, xr)
        _check(jnp.ndim(n1) == 0 and jnp.ndim(n2) == 0 and jnp.ndim(n3) == 0)
    
        gl = hypgeom.arb_hypgeom_gamma_lower_fmpq_0_bsplit(xr, xr, n_terms=8)
        gu = hypgeom.arb_hypgeom_gamma_upper_fmpq_inf_bsplit(xr, xr, n_terms=8)
        gs = hypgeom.arb_hypgeom_gamma_upper_singular_si_bsplit(2, xr, n_terms=8)
        _check(gl.shape == (2,) and gu.shape == (2,) and gs.shape == (2,))
    
        si = hypgeom.arb_hypgeom_si_1f2(xr, n_terms=8)
        ci = hypgeom.arb_hypgeom_ci_2f3(xr, n_terms=8)
        _check(si.shape == (2,) and ci.shape == (2,))
    
        airy = hypgeom.acb_hypgeom_airy_series(xc, length=4)
        _check(airy.shape == (4, 4))
        ei = hypgeom.acb_hypgeom_ei_series(xc, length=4)
        _check(ei.shape == (4, 4))
    
>       jet = hypgeom.acb_hypgeom_log_rising_ui_jet(xc, n=3, length=4)

tests\test_hypgeom_completeness.py:85: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
src\arbplusjax\hypgeom.py:5960: in acb_hypgeom_log_rising_ui_jet
    return _smi.acb_hypgeom_log_rising_ui_jet(x, n=n, length=length)
src\arbplusjax\series_missing_impl.py:1468: in acb_hypgeom_log_rising_ui_jet
    return _jet_complex(f, x, length)
src\arbplusjax\series_missing_impl.py:147: in _jet_complex
    vals = su.taylor_series_unary_complex(fn, mid, length)
src\arbplusjax\series_utils.py:39: in taylor_series_unary_complex
    val = fr(0.0) + 1j * fi(0.0)
src\arbplusjax\series_utils.py:30: in f_real
    return jnp.real(fn(z0 + t))
src\arbplusjax\series_missing_impl.py:1467: in <lambda>
    f = lambda t: jnp.exp(jsp.gammaln(t + n) - jsp.gammaln(t))
..\..\..\..\anaconda3\Lib\site-packages\jax\_src\scipy\special.py:67: in gammaln
    return lax.lgamma(x)
..\..\..\..\anaconda3\Lib\site-packages\jax\_src\lax\special.py:46: in lgamma
    return lgamma_p.bind(x)
..\..\..\..\anaconda3\Lib\site-packages\jax\_src\core.py:438: in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
..\..\..\..\anaconda3\Lib\site-packages\jax\_src\core.py:442: in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
..\..\..\..\anaconda3\Lib\site-packages\jax\_src\core.py:955: in process_primitive
    return primitive.impl(*tracers, **params)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

prim = lgamma, args = (Array(3.225+0.125j, dtype=complex128),), params = {}
fun = <PjitFunction of <function lgamma at 0x000001C54E1676A0>>, prev = None

    def apply_primitive(prim, *args, **params):
      """Impl rule that compiles and runs a single primitive 'prim' using XLA."""
      fun = xla_primitive_callable(prim, **params)
      # TODO(yashkatariya): Investigate adding is_primitive to jit and never
      # triggering the disable jit path instead of messing around with it here.
      prev = lib.jax_jit.swap_thread_local_state_disable_jit(False)
      try:
>       outs = fun(*args)
E       TypeError: lgamma does not accept dtype complex128. Accepted dtypes are subtypes of floating.
E       --------------------
E       For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

..\..\..\..\anaconda3\Lib\site-packages\jax\_src\dispatch.py:91: TypeError
============================== warnings summary ===============================
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
  C:\Users\phili\anaconda3\Lib\site-packages\jax\_src\numpy\lax_numpy.py:5426: ComplexWarning: Casting complex values to real discards the imaginary part
    out_array: Array = lax_internal._convert_element_type(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_hypgeom_completeness.py::test_hypgeom_lower_level_helpers_shapes
1 failed, 23 passed, 1 skipped, 8 warnings in 190.93s (0:03:10)
